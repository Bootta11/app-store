services:
  "{{STACK_NAME}}_mysql_backup":
    image: databack/mysql-backup
    environment:
      - "DB_SERVER={{DB_SERVER}}"
      - "DB_PORT={{DB_PORT}}"
      - "DB_USER={{DB_USER}}"
      - "DB_PASS={{DB_PASS}}"
      - "DB_NAMES={{DB_NAMES}}"
      - "DB_NAMES_EXCLUDE={{DB_NAMES_EXCLUDE}}"
      - "SINGLE_DATABASE={{SINGLE_DATABASE}}"
      - "DB_DUMP_FREQ={{DB_DUMP_FREQ}}"
      - "DB_DUMP_BEGIN={{DB_DUMP_BEGIN}}"
      - "DB_DUMP_CRON={{DB_DUMP_CRON}}"
      - "RUN_ONCE={{RUN_ONCE}}"
      - "DB_DUMP_DEBUG={{DB_DUMP_DEBUG}}"
      - "DB_DUMP_TARGET={{DB_DUMP_TARGET}}"
      - "DB_DUMP_SAFECHARS={{DB_DUMP_SAFECHARS}}"
      - "AWS_ACCESS_KEY_ID={{AWS_ACCESS_KEY_ID}}"
      - "AWS_SECRET_ACCESS_KEY={{AWS_SECRET_ACCESS_KEY}}"
      - "AWS_DEFAULT_REGION={{AWS_DEFAULT_REGION}}"
      - "AWS_ENDPOINT_URL={{AWS_ENDPOINT_URL}}"
      - "AWS_CLI_OPTS={{AWS_CLI_OPTS}}"
      - "AWS_CLI_S3_CP_OPTS={{AWS_CLI_S3_CP_OPTS}}"
      - "SMB_USER={{SMB_USER}}"
      - "SMB_PASS={{SMB_PASS}}"
      - "COMPRESSION={{COMPRESSION}}"
      - "DB_DUMP_BY_SCHEMA={{DB_DUMP_BY_SCHEMA}}"
      - "DB_DUMP_KEEP_PERMISSIONS={{DB_DUMP_KEEP_PERMISSIONS}}"
      - "MYSQLDUMP_OPTS={{MYSQLDUMP_OPTS}}"
      - "NICE={{NICE}}"
      - "TMP_PATH={{TMP_PATH}}"
    volumes:
      - "{{LOCAL_FILE_PATH}}:{{CONTAINER_DUMP_PATH}}"
docs:
  logo_url: "https://example.com/path_to_mysql_backup_logo.png"
  name: "MySQL Backup"
  description: "Efficient and flexible backups for your MySQL databases, directly from your container."
  readme_description: >
    ### What is MySQL Backup?

    MySQL Backup is a tool for performing database backups efficiently and flexibly. It can handle backups locally or remotely, including support for SMB and S3 targets.

    ### Features

    - Scheduled backups using cron
    - Backup compression and environment variable configurations
    - Support for multiple dump targets

    ### Links

    - Support and Issues - [databack/mysql-backup](https://github.com/databack/mysql-backup)
    - Official Documentation - [mysql-backup-docs.com](https://mysql-backup-docs.com)

  iframe_video_embed: ""
  variables:
    DB_SERVER:
      title: "Database Server"
      description: "Hostname or IP of the database server"
      default: ""
      type: text
    DB_PORT:
      title: "Database Port"
      description: "Port number for the database connection"
      default: "3306"
      type: text
    DB_USER:
      title: "Database User"
      description: "Username for the database"
      default: ""
      type: text
    DB_PASS:
      title: "Database Password"
      description: "Password for the database user"
      default: ""
      type: text
    DB_DUMP_FREQ:
      title: "Dump Frequency"
      description: "How often to perform backups (in minutes)"
      default: "1440"
      type: text
    DB_DUMP_BEGIN:
      title: "First Dump Schedule"
      description: "Time to start the first backup, HHMM format or +MM after container starts"
      default: "+0"
      type: text
    DB_DUMP_TARGET:
      title: "Dump Target"
      description: "Where to store the backup files, supports local path or URLs (SMB, S3)"
      default: "/backup"
      type: text
    SINGLE_DATABASE:
      title: "Single Database"
      description: "Set to true to enable single database dump"
      default: "false"
      type: options
      options:
        - title: "true"
          value: "true"
        - title: "false"
          value: "false"
    AWS_ACCESS_KEY_ID:
      title: "AWS Access Key ID"
      description: "AWS key ID for S3 integration"
      default: ""
      type: text
    AWS_SECRET_ACCESS_KEY:
      title: "AWS Secret Access Key"
      description: "AWS secret access key for S3 integration"
      default: ""
      type: text
    AWS_DEFAULT_REGION:
      title: "AWS Region"
      description: "AWS region where the S3 bucket is located"
      default: ""
      type: text
    SMB_USER:
      title: "SMB Username"
      description: "Username for SMB server authentication"
      default: ""
      type: text
    SMB_PASS:
      title: "SMB Password"
      description: "Password for SMB server authentication"
      default: ""
      type: text
